<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>vonmises package &mdash; vonmises-icml-2023  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="vonmises" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            vonmises-icml-2023
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">vonmises</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">vonmises package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.confdists">vonmises.confdists module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.SampleDistribution"><code class="docutils literal notranslate"><span class="pre">SampleDistribution</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.compute_dihedral_hist"><code class="docutils literal notranslate"><span class="pre">compute_dihedral_hist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.compute_dihedral_list"><code class="docutils literal notranslate"><span class="pre">compute_dihedral_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.compute_distance_avg_path_lim"><code class="docutils literal notranslate"><span class="pre">compute_distance_avg_path_lim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.compute_distance_lists"><code class="docutils literal notranslate"><span class="pre">compute_distance_lists()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.get_atom_pair_restrict_to_non_aromatic_ring"><code class="docutils literal notranslate"><span class="pre">get_atom_pair_restrict_to_non_aromatic_ring()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.get_atom_pair_restrict_to_non_ring"><code class="docutils literal notranslate"><span class="pre">get_atom_pair_restrict_to_non_ring()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.confdists.get_atom_pair_restrict_to_vm_preds"><code class="docutils literal notranslate"><span class="pre">get_atom_pair_restrict_to_vm_preds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.dbdataset">vonmises.dbdataset module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.GraphDBDataset"><code class="docutils literal notranslate"><span class="pre">GraphDBDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.SubsetSampler"><code class="docutils literal notranslate"><span class="pre">SubsetSampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.TargetsLoader"><code class="docutils literal notranslate"><span class="pre">TargetsLoader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.create_dataset"><code class="docutils literal notranslate"><span class="pre">create_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.db_row_to_angle_targets"><code class="docutils literal notranslate"><span class="pre">db_row_to_angle_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.db_row_to_chirality_targets"><code class="docutils literal notranslate"><span class="pre">db_row_to_chirality_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.db_row_to_length_targets"><code class="docutils literal notranslate"><span class="pre">db_row_to_length_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.db_row_to_torsion_targets"><code class="docutils literal notranslate"><span class="pre">db_row_to_torsion_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.dbdataset.set_sqlite_pragma"><code class="docutils literal notranslate"><span class="pre">set_sqlite_pragma()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.etkdg">vonmises.etkdg module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.copy_confs"><code class="docutils literal notranslate"><span class="pre">copy_confs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.force_chiral_for_atoms_with_4_neighbors"><code class="docutils literal notranslate"><span class="pre">force_chiral_for_atoms_with_4_neighbors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.force_stereo_for_double_bonds"><code class="docutils literal notranslate"><span class="pre">force_stereo_for_double_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.generate_clean_etkdg_confs"><code class="docutils literal notranslate"><span class="pre">generate_clean_etkdg_confs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.generate_etkdg_confs"><code class="docutils literal notranslate"><span class="pre">generate_etkdg_confs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.get_atom_det"><code class="docutils literal notranslate"><span class="pre">get_atom_det()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.get_det_values_for_conf"><code class="docutils literal notranslate"><span class="pre">get_det_values_for_conf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.get_double_bonds"><code class="docutils literal notranslate"><span class="pre">get_double_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.set_chiral_for_all_unset_atoms_based_on_pos"><code class="docutils literal notranslate"><span class="pre">set_chiral_for_all_unset_atoms_based_on_pos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.etkdg.set_stereo_for_double_bonds_based_on_pos"><code class="docutils literal notranslate"><span class="pre">set_stereo_for_double_bonds_based_on_pos()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.featurize_mols">vonmises.featurize_mols module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.featurize_mols.FeaturizeAngles"><code class="docutils literal notranslate"><span class="pre">FeaturizeAngles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.featurize_mols.FeaturizeAtoms"><code class="docutils literal notranslate"><span class="pre">FeaturizeAtoms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.featurize_mols.FeaturizeBonds"><code class="docutils literal notranslate"><span class="pre">FeaturizeBonds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.featurize_mols.FeaturizeMol"><code class="docutils literal notranslate"><span class="pre">FeaturizeMol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.featurize_mols.PreprocessMol"><code class="docutils literal notranslate"><span class="pre">PreprocessMol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.featurize_mols.to_one_hot"><code class="docutils literal notranslate"><span class="pre">to_one_hot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.graph_builders">vonmises.graph_builders module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.graph_builders.BuildVonMisesGraph"><code class="docutils literal notranslate"><span class="pre">BuildVonMisesGraph</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.graph_builders.CalculateAdjacencyMatrix"><code class="docutils literal notranslate"><span class="pre">CalculateAdjacencyMatrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.graph_builders.CalculateMask"><code class="docutils literal notranslate"><span class="pre">CalculateMask</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.mol_utils">vonmises.mol_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.TorsionBondType"><code class="docutils literal notranslate"><span class="pre">TorsionBondType</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.calc_energy_grad"><code class="docutils literal notranslate"><span class="pre">calc_energy_grad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.classify_bonds_torsion_type"><code class="docutils literal notranslate"><span class="pre">classify_bonds_torsion_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_angle"><code class="docutils literal notranslate"><span class="pre">compute_angle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_angle_triplets"><code class="docutils literal notranslate"><span class="pre">compute_angle_triplets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_angles"><code class="docutils literal notranslate"><span class="pre">compute_angles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_aromatic_ring_bond_torsions"><code class="docutils literal notranslate"><span class="pre">compute_aromatic_ring_bond_torsions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_aromatic_ring_bonds"><code class="docutils literal notranslate"><span class="pre">compute_aromatic_ring_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_bond_idxs"><code class="docutils literal notranslate"><span class="pre">compute_bond_idxs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_chirality"><code class="docutils literal notranslate"><span class="pre">compute_chirality()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_chirality_all_confs"><code class="docutils literal notranslate"><span class="pre">compute_chirality_all_confs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_chirality_probability_targets"><code class="docutils literal notranslate"><span class="pre">compute_chirality_probability_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_lengths"><code class="docutils literal notranslate"><span class="pre">compute_lengths()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_non_aromatic_ring_bond_torsions"><code class="docutils literal notranslate"><span class="pre">compute_non_aromatic_ring_bond_torsions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_non_aromatic_ring_bonds"><code class="docutils literal notranslate"><span class="pre">compute_non_aromatic_ring_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_non_rotatable_non_ring_bond_torsions"><code class="docutils literal notranslate"><span class="pre">compute_non_rotatable_non_ring_bond_torsions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_non_rotatable_non_ring_bonds"><code class="docutils literal notranslate"><span class="pre">compute_non_rotatable_non_ring_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_num_torsion_modes"><code class="docutils literal notranslate"><span class="pre">compute_num_torsion_modes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_rotatable_bond_torsions"><code class="docutils literal notranslate"><span class="pre">compute_rotatable_bond_torsions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_torsions"><code class="docutils literal notranslate"><span class="pre">compute_torsions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_torsions_data_frame"><code class="docutils literal notranslate"><span class="pre">compute_torsions_data_frame()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_torsions_for_bond"><code class="docutils literal notranslate"><span class="pre">compute_torsions_for_bond()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.compute_volume"><code class="docutils literal notranslate"><span class="pre">compute_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.count_lone_pairs"><code class="docutils literal notranslate"><span class="pre">count_lone_pairs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.draw_mol"><code class="docutils literal notranslate"><span class="pre">draw_mol()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.filter_conformation"><code class="docutils literal notranslate"><span class="pre">filter_conformation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.flip_chirality"><code class="docutils literal notranslate"><span class="pre">flip_chirality()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.get_all_conf_pos"><code class="docutils literal notranslate"><span class="pre">get_all_conf_pos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.get_bond_index_paths"><code class="docutils literal notranslate"><span class="pre">get_bond_index_paths()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.get_bond_sorted_atoms"><code class="docutils literal notranslate"><span class="pre">get_bond_sorted_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.get_conf_dist"><code class="docutils literal notranslate"><span class="pre">get_conf_dist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.neighbor_search"><code class="docutils literal notranslate"><span class="pre">neighbor_search()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.plot_torsion_joint_histograms"><code class="docutils literal notranslate"><span class="pre">plot_torsion_joint_histograms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.rdkit_get_bond_index_paths_slow"><code class="docutils literal notranslate"><span class="pre">rdkit_get_bond_index_paths_slow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.reorder_mol_atoms_like_smiles"><code class="docutils literal notranslate"><span class="pre">reorder_mol_atoms_like_smiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.select_atom_priority_indices_for_chirality"><code class="docutils literal notranslate"><span class="pre">select_atom_priority_indices_for_chirality()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.select_atom_priority_neighbor"><code class="docutils literal notranslate"><span class="pre">select_atom_priority_neighbor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.mol_utils.select_dihedral_atom_indices"><code class="docutils literal notranslate"><span class="pre">select_dihedral_atom_indices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.net_utils">vonmises.net_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.net_utils.dense_loss"><code class="docutils literal notranslate"><span class="pre">dense_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.net_utils.dense_loss_chirality"><code class="docutils literal notranslate"><span class="pre">dense_loss_chirality()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.net_utils.param_count"><code class="docutils literal notranslate"><span class="pre">param_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.net_utils.von_mises_logprob_nogeo"><code class="docutils literal notranslate"><span class="pre">von_mises_logprob_nogeo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.net_utils.von_mises_loss_stable"><code class="docutils literal notranslate"><span class="pre">von_mises_loss_stable()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.nets">vonmises.nets module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.nets.GCNLayer"><code class="docutils literal notranslate"><span class="pre">GCNLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.nets.GCNStack"><code class="docutils literal notranslate"><span class="pre">GCNStack</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.nets.OutputLayer"><code class="docutils literal notranslate"><span class="pre">OutputLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.nets.VonMisesNet"><code class="docutils literal notranslate"><span class="pre">VonMisesNet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.nets.get_normalization_module"><code class="docutils literal notranslate"><span class="pre">get_normalization_module()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.predictor">vonmises.predictor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.predictor.Predictor"><code class="docutils literal notranslate"><span class="pre">Predictor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.predictor.generate_confs"><code class="docutils literal notranslate"><span class="pre">generate_confs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.predictor.set_torsion_angle_from_predictions"><code class="docutils literal notranslate"><span class="pre">set_torsion_angle_from_predictions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises.sqlalchemy_model">vonmises.sqlalchemy_model module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.sqlalchemy_model.Molecule"><code class="docutils literal notranslate"><span class="pre">Molecule</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.sqlalchemy_model.create_session"><code class="docutils literal notranslate"><span class="pre">create_session()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vonmises.sqlalchemy_model.subset_query"><code class="docutils literal notranslate"><span class="pre">subset_query()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-vonmises">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">vonmises-icml-2023</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">vonmises</a></li>
      <li class="breadcrumb-item active">vonmises package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/vonmises.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vonmises-package">
<h1>vonmises package<a class="headerlink" href="#vonmises-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-vonmises.confdists">
<span id="vonmises-confdists-module"></span><h2>vonmises.confdists module<a class="headerlink" href="#module-vonmises.confdists" title="Permalink to this heading"></a></h2>
<p>Conformation distributions and utilities for evaluation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.confdists.SampleDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">SampleDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#SampleDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.SampleDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A distribution of conformations with metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>meta</strong> (<em>Dict</em>) – Metadata dictionary.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.confdists.SampleDistribution.get_dist_mats">
<span class="sig-name descname"><span class="pre">get_dist_mats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#SampleDistribution.get_dist_mats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.SampleDistribution.get_dist_mats" title="Permalink to this definition"></a></dt>
<dd><p>Get distance matrix from conformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Distance matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.compute_dihedral_hist">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">compute_dihedral_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filler_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#compute_dihedral_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.compute_dihedral_hist" title="Permalink to this definition"></a></dt>
<dd><p>Compute histograms of rotatable bond torsion angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> (<a class="reference internal" href="#vonmises.confdists.SampleDistribution" title="vonmises.confdists.SampleDistribution"><em>SampleDistribution</em></a>) – SampleDistribution object with conformations.</p></li>
<li><p><strong>bins</strong> – Number of histogram bins to use.</p></li>
<li><p><strong>filler_value</strong> (<em>float</em>) – Non-zero value to support histogram computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping bond index to histogram.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.compute_dihedral_list">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">compute_dihedral_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#compute_dihedral_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.compute_dihedral_list" title="Permalink to this definition"></a></dt>
<dd><p>Compute sets of rotatable bond torsion angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist</strong> (<a class="reference internal" href="#vonmises.confdists.SampleDistribution" title="vonmises.confdists.SampleDistribution"><em>SampleDistribution</em></a>) – SampleDistribution object with conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping bond index to list of torsion angles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.compute_distance_avg_path_lim">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">compute_distance_avg_path_lim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_atom_path_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_atom_path_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_vm_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_non_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_non_aromatic_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#compute_distance_avg_path_lim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.compute_distance_avg_path_lim" title="Permalink to this definition"></a></dt>
<dd><p>Compute average distances between pairs of atoms whose topological distance is within given bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> (<a class="reference internal" href="#vonmises.confdists.SampleDistribution" title="vonmises.confdists.SampleDistribution"><em>SampleDistribution</em></a>) – SampleDistribution object with conformations.</p></li>
<li><p><strong>min_atom_path_len</strong> (<em>int</em>) – Minimum topological pairwise distance between atoms, measured in # atoms along the path.</p></li>
<li><p><strong>max_atom_path_len</strong> (<em>int</em>) – Maximum topological pairwise distance between atoms, measured in # atoms along the path.</p></li>
<li><p><strong>restrict_to_vm_preds</strong> (<em>bool</em>) – Whether or not to restrict computations to VonMisesNet predictions.</p></li>
<li><p><strong>restrict_to_non_ring</strong> (<em>bool</em>) – Whether or not to restrict computations to non-ring components.</p></li>
<li><p><strong>restrict_to_non_aromatic_ring</strong> (<em>bool</em>) – Whether or not to restrict computations to exclude non-aromatic ring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping from atom indices and path length tuple to average pairwise distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.compute_distance_lists">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">compute_distance_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_atom_path_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_atom_path_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_vm_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_non_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_non_aromatic_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#compute_distance_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.compute_distance_lists" title="Permalink to this definition"></a></dt>
<dd><p>Compute all distances between pairs of atoms whose topological distance is within given bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist</strong> (<a class="reference internal" href="#vonmises.confdists.SampleDistribution" title="vonmises.confdists.SampleDistribution"><em>SampleDistribution</em></a>) – SampleDistribution object with conformation.</p></li>
<li><p><strong>min_atom_path_len</strong> (<em>int</em>) – Minimum topological pairwise distance between atoms, measured in # atoms along the path.</p></li>
<li><p><strong>max_atom_path_len</strong> (<em>int</em>) – Maximum topological pairwise distance between atoms, measured in # atoms along the path.</p></li>
<li><p><strong>restrict_to_vm_preds</strong> (<em>bool</em>) – Whether or not to restrict computations to VonMisesNet predictions.</p></li>
<li><p><strong>restrict_to_non_ring</strong> (<em>bool</em>) – Whether or not to restrict computations to non-ring components.</p></li>
<li><p><strong>restrict_to_non_aromatic_ring</strong> (<em>bool</em>) – Whether or not to restrict computations to exclude non-aromatic ring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping from atom indices and path length tuple to list of pairwise distance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.get_atom_pair_restrict_to_non_aromatic_ring">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">get_atom_pair_restrict_to_non_aromatic_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#get_atom_pair_restrict_to_non_aromatic_ring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.get_atom_pair_restrict_to_non_aromatic_ring" title="Permalink to this definition"></a></dt>
<dd><p>Determine if distances between a particular pair of atoms with non-aromatic ring restriction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – RDKit mol object.</p></li>
<li><p><strong>atom_index_a</strong> (<em>int</em>) – First atom index.</p></li>
<li><p><strong>atom_index_b</strong> (<em>int</em>) – Second atom index.</p></li>
<li><p><strong>shortest_paths</strong> (<em>Dict</em>) – Shortest paths dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean indicating inclusion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.get_atom_pair_restrict_to_non_ring">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">get_atom_pair_restrict_to_non_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#get_atom_pair_restrict_to_non_ring"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.get_atom_pair_restrict_to_non_ring" title="Permalink to this definition"></a></dt>
<dd><p>Determine if distances between a particular pair of atoms with non-ring restriction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – RDKit mol object.</p></li>
<li><p><strong>atom_index_a</strong> (<em>int</em>) – First atom index.</p></li>
<li><p><strong>atom_index_b</strong> (<em>int</em>) – Second atom index.</p></li>
<li><p><strong>shortest_paths</strong> (<em>Dict</em>) – Shortest paths dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean indicating inclusion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.confdists.get_atom_pair_restrict_to_vm_preds">
<span class="sig-prename descclassname"><span class="pre">vonmises.confdists.</span></span><span class="sig-name descname"><span class="pre">get_atom_pair_restrict_to_vm_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/confdists.html#get_atom_pair_restrict_to_vm_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.confdists.get_atom_pair_restrict_to_vm_preds" title="Permalink to this definition"></a></dt>
<dd><p>Determine if distances between a particular pair of atoms are included in VM predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – RDKit mol object.</p></li>
<li><p><strong>atom_index_a</strong> (<em>int</em>) – First atom index.</p></li>
<li><p><strong>atom_index_b</strong> (<em>int</em>) – Second atom index.</p></li>
<li><p><strong>shortest_paths</strong> (<em>Dict</em>) – Shortest paths dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean indicating inclusion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.dbdataset">
<span id="vonmises-dbdataset-module"></span><h2>vonmises.dbdataset module<a class="headerlink" href="#module-vonmises.dbdataset" title="Permalink to this heading"></a></h2>
<p>PyTorch Dataset.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.dbdataset.GraphDBDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">GraphDBDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_targets_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_targets_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_targets_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chirality_targets_db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feat_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feat_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_build_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#GraphDBDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.GraphDBDataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Dataset class for loading molecular graphs and targets, using on-disk sqlite databases.</p>
<p>Note: we delay connecting to the database until we request the first item _and_ we check to see if the PID is the
same; this is to deal with Pytorch’s “numworkers” forking and difficulties with Python Multiprocessing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_path</strong> (<em>str</em>) – Path to SQLite database containing molecules.</p></li>
<li><p><strong>molecule_ids</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – Molecule ids in SQLite database.</p></li>
<li><p><strong>torsion_targets_db</strong> (<em>str</em>) – Path to torsion targets database.</p></li>
<li><p><strong>angle_targets_db</strong> (<em>str</em>) – Path to bond angle targets database.</p></li>
<li><p><strong>len_targets_db</strong> (<em>str</em>) – Path to bond length targets database.</p></li>
<li><p><strong>chirality_targets_db</strong> (<em>str</em>) – Path to chirality targets database.</p></li>
<li><p><strong>cache_features</strong> (<em>bool</em>) – Whether or not to cache features in memory for faster loading.</p></li>
<li><p><strong>atom_feat_config</strong> (<em>Dict</em>) – Dictionary of atom parameters.</p></li>
<li><p><strong>bond_feat_config</strong> (<em>Dict</em>) – Dictionary of bond parameters.</p></li>
<li><p><strong>graph_build_config</strong> (<em>Dict</em>) – Dictionary of graph building parameters.</p></li>
<li><p><strong>preprocess_config</strong> (<em>Dict</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.dbdataset.SubsetSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">SubsetSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#SubsetSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.SubsetSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></p>
<p>A dataset sampler for sampling a subset of data for each epoch, in order to have epochs of the same size to
compare training performance across different datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch_size</strong> – Size of the epoch.</p></li>
<li><p><strong>ds_size</strong> – Total size of the dataset.</p></li>
<li><p><strong>shuffle</strong> – Whether or not to shuffle.</p></li>
<li><p><strong>world_size</strong> – World size.</p></li>
<li><p><strong>rank</strong> – Rank.</p></li>
<li><p><strong>seed</strong> – Random seed.</p></li>
<li><p><strong>logging_name</strong> – Logger name.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.dbdataset.SubsetSampler.compute_idx">
<span class="sig-name descname"><span class="pre">compute_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#SubsetSampler.compute_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.SubsetSampler.compute_idx" title="Permalink to this definition"></a></dt>
<dd><p>Compute index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vonmises.dbdataset.SubsetSampler.get_state">
<span class="sig-name descname"><span class="pre">get_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#SubsetSampler.get_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.SubsetSampler.get_state" title="Permalink to this definition"></a></dt>
<dd><p>Returns the state to reinitialize the sampler.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vonmises.dbdataset.SubsetSampler.set_state">
<span class="sig-name descname"><span class="pre">set_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#SubsetSampler.set_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.SubsetSampler.set_state" title="Permalink to this definition"></a></dt>
<dd><p>Set the state of the sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> – State dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.dbdataset.TargetsLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">TargetsLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_deserialize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#TargetsLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.TargetsLoader" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Database connection for loading and deserializing targets from a database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> – Filename of database.</p></li>
<li><p><strong>row_deserialize</strong> – Function to use for row deserialization.</p></li>
<li><p><strong>table_name</strong> – Table name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.dbdataset.create_dataset">
<span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">create_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_basename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_ids</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">exp_config_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#create_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.create_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Create a GraphDBDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_db_filename</strong> – Molecule database filename.</p></li>
<li><p><strong>target_basename</strong> – Target databases base filename.</p></li>
<li><p><strong>dataset_ids</strong> – List of ids.</p></li>
<li><p><strong>exp_config_params</strong> – Experiment config parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>GraphDBDataset object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#vonmises.dbdataset.GraphDBDataset" title="vonmises.dbdataset.GraphDBDataset"><em>GraphDBDataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.dbdataset.db_row_to_angle_targets">
<span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">db_row_to_angle_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#db_row_to_angle_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.db_row_to_angle_targets" title="Permalink to this definition"></a></dt>
<dd><p>Deserialize a row from a bond angle targets database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> – Database row.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deserialized bond angle targets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.dbdataset.db_row_to_chirality_targets">
<span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">db_row_to_chirality_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#db_row_to_chirality_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.db_row_to_chirality_targets" title="Permalink to this definition"></a></dt>
<dd><p>Deserialize a row from a chirality targets database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> – Database row.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deserialized chirality targets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.dbdataset.db_row_to_length_targets">
<span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">db_row_to_length_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#db_row_to_length_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.db_row_to_length_targets" title="Permalink to this definition"></a></dt>
<dd><p>Deserialize a row from a bond length targets database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> – Database row.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deserialized bond length targets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.dbdataset.db_row_to_torsion_targets">
<span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">db_row_to_torsion_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#db_row_to_torsion_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.db_row_to_torsion_targets" title="Permalink to this definition"></a></dt>
<dd><p>Deserialize a row from a torsion targets database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> – Database row.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deserialized torsion targets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.dbdataset.set_sqlite_pragma">
<span class="sig-prename descclassname"><span class="pre">vonmises.dbdataset.</span></span><span class="sig-name descname"><span class="pre">set_sqlite_pragma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/dbdataset.html#set_sqlite_pragma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.dbdataset.set_sqlite_pragma" title="Permalink to this definition"></a></dt>
<dd><p>Try and increase performance: <a class="reference external" href="https://blog.devart.com/increasing-sqlite-performance.html">https://blog.devart.com/increasing-sqlite-performance.html</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbapi_connection</strong> – Database connection.</p></li>
<li><p><strong>connection_record</strong> – Connection record.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.etkdg">
<span id="vonmises-etkdg-module"></span><h2>vonmises.etkdg module<a class="headerlink" href="#module-vonmises.etkdg" title="Permalink to this heading"></a></h2>
<p>We have identified several places where etkdg does not maintain atomic identities. These are our workarounds.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.copy_confs">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">copy_confs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf_source_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#copy_confs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.copy_confs" title="Permalink to this definition"></a></dt>
<dd><p>Copy conformations to a new mol object. This provides a way to transfer conformations in the event that the
conformation-generation modifies properties of the input molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf_source_mol</strong> (<em>Mol</em>) – Source RDKit mol object.</p></li>
<li><p><strong>target_mol</strong> (<em>Mol</em>) – Output RDKit mol object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New mol object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Mol</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.force_chiral_for_atoms_with_4_neighbors">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">force_chiral_for_atoms_with_4_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#force_chiral_for_atoms_with_4_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.force_chiral_for_atoms_with_4_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>If a molecule has 4 neighbors and does not have chirality set, force it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.force_stereo_for_double_bonds">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">force_stereo_for_double_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#force_stereo_for_double_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.force_stereo_for_double_bonds" title="Permalink to this definition"></a></dt>
<dd><p>Force a fixed stereo for double bonds in the molecule that do not already have stereo set. This mutates the
input molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.generate_clean_etkdg_confs">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">generate_clean_etkdg_confs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orig_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign_chi_to_tet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign_stereo_to_double</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conform_to_existing_conf_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_embed_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception_for_num_failure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#generate_clean_etkdg_confs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.generate_clean_etkdg_confs" title="Permalink to this definition"></a></dt>
<dd><p>Generate ETKDG tags in a way that preserves chirality and double bond stereochemistry.
Return a new molecule with the generated conformations, having removed the old ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orig_mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>num</strong> (<em>int</em>) – Number of conformations to generate.</p></li>
<li><p><strong>assign_chi_to_tet</strong> (<em>bool</em>) – Whether or not to preserve chirality.</p></li>
<li><p><strong>assign_stereo_to_double</strong> (<em>bool</em>) – Whether or not to preserve double bond stereochemistry.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
<li><p><strong>conform_to_existing_conf_idx</strong> (<em>int</em>) – If &gt;= 0, the chirality of the existing conformation at this index will be used.</p></li>
<li><p><strong>max_embed_attempts</strong> (<em>int</em>) – Maximum number of ETKDG embeddings to try before giving up.</p></li>
<li><p><strong>exception_for_num_failure</strong> (<em>bool</em>) – Raise an exception if fail to generate requested number of conformations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New RDKit mol object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Mol</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.generate_etkdg_confs">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">generate_etkdg_confs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orig_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_embed_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#generate_etkdg_confs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.generate_etkdg_confs" title="Permalink to this definition"></a></dt>
<dd><p>ETKDG wrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orig_mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>num</strong> (<em>int</em>) – Number of conformations to generate.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
<li><p><strong>max_embed_attempts</strong> (<em>int</em>) – Number of times to re-try failed ETKDG embedding before giving up.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New mol object with generated conformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Mol</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.get_atom_det">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">get_atom_det</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#get_atom_det"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.get_atom_det" title="Permalink to this definition"></a></dt>
<dd><p>For the 3 atoms in the position matrix, return the determinant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<em>ndarray</em>) – Position matrix of 3 atoms.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Determinant.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>array</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.get_det_values_for_conf">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">get_det_values_for_conf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#get_det_values_for_conf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.get_det_values_for_conf" title="Permalink to this definition"></a></dt>
<dd><p>Get the determinant for all atoms with 4 neighbors in a molecule for a specified conformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>conf_idx</strong> (<em>int</em>) – Conformation index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping from atom index to determinant.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.get_double_bonds">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">get_double_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#get_double_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.get_double_bonds" title="Permalink to this definition"></a></dt>
<dd><p>Get double bonds of a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of double bonds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.set_chiral_for_all_unset_atoms_based_on_pos">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">set_chiral_for_all_unset_atoms_based_on_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#set_chiral_for_all_unset_atoms_based_on_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.set_chiral_for_all_unset_atoms_based_on_pos" title="Permalink to this definition"></a></dt>
<dd><p>For all atoms that don’t currently have a chirality tag set, set it based on the geometry in a way that future
runs of ETKDG will generate the same chirality. This mutates the input molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>conf_idx</strong> (<em>int</em>) – Conformation index</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.etkdg.set_stereo_for_double_bonds_based_on_pos">
<span class="sig-prename descclassname"><span class="pre">vonmises.etkdg.</span></span><span class="sig-name descname"><span class="pre">set_stereo_for_double_bonds_based_on_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/etkdg.html#set_stereo_for_double_bonds_based_on_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.etkdg.set_stereo_for_double_bonds_based_on_pos" title="Permalink to this definition"></a></dt>
<dd><p>For all bonds that don’t currently have a stereochem tag set, set it based on the geometry in a way that future
runs of ETKDG will generate the same geometry. This mutates the input molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>conf_idx</strong> (<em>int</em>) – Conformation index.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.featurize_mols">
<span id="vonmises-featurize-mols-module"></span><h2>vonmises.featurize_mols module<a class="headerlink" href="#module-vonmises.featurize_mols" title="Permalink to this heading"></a></h2>
<p>Functions to featurize molecules.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.featurize_mols.FeaturizeAngles">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.featurize_mols.</span></span><span class="sig-name descname"><span class="pre">FeaturizeAngles</span></span><a class="reference internal" href="_modules/vonmises/featurize_mols.html#FeaturizeAngles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.featurize_mols.FeaturizeAngles" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate the bond angle features for a molecule.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.featurize_mols.FeaturizeAtoms">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.featurize_mols.</span></span><span class="sig-name descname"><span class="pre">FeaturizeAtoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mmff_atom_types_one_hot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assign_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aromatic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hybridization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hybridization_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partial_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formal_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_covalent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_vanderwals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_valence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ring_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chirality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmff94_atom_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hydrogen_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_radical_electron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_radical_electron_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/featurize_mols.html#FeaturizeAtoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.featurize_mols.FeaturizeAtoms" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate the atom features for a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mmff_atom_types_one_hot</strong> (<em>bool</em>) – Whether or not to include MMFF94 atom types as vertex features.</p></li>
<li><p><strong>assign_stereo</strong> (<em>bool</em>) – Whether or not to include stereochemistry information.</p></li>
<li><p><strong>atomic_num</strong> (<em>bool</em>) – Whether or not to include atomic number as a vertex feature.</p></li>
<li><p><strong>atom_types</strong> (<em>List</em>) – List of allowed atomic numbers.</p></li>
<li><p><strong>valence</strong> (<em>bool</em>) – Whether or not to include total valence as a vertex feature.</p></li>
<li><p><strong>valence_types</strong> (<em>List</em>) – List of allowed total valence numbers.</p></li>
<li><p><strong>aromatic</strong> (<em>bool</em>) – Whether or not to include aromaticity as a vertex feature.</p></li>
<li><p><strong>hybridization</strong> (<em>bool</em>) – Whether or not to include hybridization as a vertex feature.</p></li>
<li><p><strong>hybridization_types</strong> (<em>List</em>) – Hybridization types.</p></li>
<li><p><strong>partial_charge</strong> (<em>bool</em>) – Whether or not to include Gasteiger Charge as a vertex feature.</p></li>
<li><p><strong>formal_charge</strong> (<em>bool</em>) – Whether or not to include formal charge as a vertex feature.</p></li>
<li><p><strong>charge_types</strong> (<em>List</em>) – Formal charge types.</p></li>
<li><p><strong>r_covalent</strong> (<em>bool</em>) – Whether or not to include covalent radius as a vertex feature.</p></li>
<li><p><strong>r_vanderwals</strong> (<em>bool</em>) – Whether or not to include vanderwals radius as a vertex feature.</p></li>
<li><p><strong>default_valence</strong> (<em>bool</em>) – Whether or not to include default valence as a vertex feature.</p></li>
<li><p><strong>max_ring_size</strong> (<em>int</em>) – Maximum ring size.</p></li>
<li><p><strong>rings</strong> (<em>bool</em>) – Whether or not to include ring size as a vertex feature.</p></li>
<li><p><strong>chirality</strong> (<em>bool</em>) – Whether or not to include chirality as a vertex feature.</p></li>
<li><p><strong>chi_types</strong> (<em>List</em>) – Chiral tag types.</p></li>
<li><p><strong>mmff94_atom_types</strong> (<em>List</em>) – MMFF94 atom types.</p></li>
<li><p><strong>degree_types</strong> (<em>List</em>) – Atomic degree types.</p></li>
<li><p><strong>degree</strong> (<em>bool</em>) – Whether or not to include degree as a vertex feature.</p></li>
<li><p><strong>num_hydrogen</strong> (<em>bool</em>) – Whether or not to include number of (neighboring) H atoms as a vertex feature.</p></li>
<li><p><strong>num_hydrogen_types</strong> (<em>bool</em>) – List of allowed number of H atoms (including neighbors).</p></li>
<li><p><strong>num_radical_electron</strong> (<em>bool</em>) – Whether or not to include number of radical electrons as a vertex feature.</p></li>
<li><p><strong>num_radical_electron_types</strong> (<em>bool</em>) – List of allowed number of radical electrons.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.featurize_mols.FeaturizeBonds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.featurize_mols.</span></span><span class="sig-name descname"><span class="pre">FeaturizeBonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conjugated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_path_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_bond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/featurize_mols.html#FeaturizeBonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.featurize_mols.FeaturizeBonds" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate the bond features for a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_types</strong> (<em>List</em>) – List of allowed bond types.</p></li>
<li><p><strong>bond_type</strong> (<em>bool</em>) – Whether or not to include bond type as an edge feature.</p></li>
<li><p><strong>conjugated</strong> (<em>bool</em>) – Whether or not to include conjugated as an edge feature.</p></li>
<li><p><strong>bond_ring</strong> (<em>bool</em>) – Whether or not to include bond being in ring as an edge feature.</p></li>
<li><p><strong>bond_stereo</strong> (<em>bool</em>) – Whether or not to include bond stereo as an edge feature.</p></li>
<li><p><strong>bond_stereo_types</strong> (<em>List</em>) – List of bond stereo types.</p></li>
<li><p><strong>shortest_path</strong> (<em>bool</em>) – Whether or not to include shortest path length as a bond feature.</p></li>
<li><p><strong>max_path_length</strong> (<em>int</em>) – Maximum shortest path length between any two atoms in a molecule in the dataset.</p></li>
<li><p><strong>same_ring</strong> (<em>bool</em>) – Whether or not to include same ring as bond feature.</p></li>
<li><p><strong>rot_bond</strong> (<em>bool</em>) – Whether or not a bond is rotatable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.featurize_mols.FeaturizeMol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.featurize_mols.</span></span><span class="sig-name descname"><span class="pre">FeaturizeMol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_feat_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feat_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/featurize_mols.html#FeaturizeMol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.featurize_mols.FeaturizeMol" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate molecular featurization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_feat_config</strong> (<em>Dict</em>) – Dictionary of atom parameters.</p></li>
<li><p><strong>bond_feat_config</strong> (<em>Dict</em>) – Dictionary of bond parameters.</p></li>
<li><p><strong>preprocess_config</strong> (<em>Dict</em>) – Dictionary of preprocess parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.featurize_mols.PreprocessMol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.featurize_mols.</span></span><span class="sig-name descname"><span class="pre">PreprocessMol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_chi_to_tet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_stereo_to_double</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conform_to_existing_conf_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/featurize_mols.html#PreprocessMol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.featurize_mols.PreprocessMol" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Any mol clean-up/sanity check that we want as part of the featurization process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_chi_to_tet</strong> (<em>bool</em>) – </p></li>
<li><p><strong>force_stereo_to_double</strong> (<em>bool</em>) – </p></li>
<li><p><strong>conform_to_existing_conf_idx</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.featurize_mols.to_one_hot">
<span class="sig-prename descclassname"><span class="pre">vonmises.featurize_mols.</span></span><span class="sig-name descname"><span class="pre">to_one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/featurize_mols.html#to_one_hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.featurize_mols.to_one_hot" title="Permalink to this definition"></a></dt>
<dd><p>Return a one-hot vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>int</em>) – Data integer.</p></li>
<li><p><strong>vals</strong> (<em>List</em>) – List of possible data values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One-hot vector as list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.graph_builders">
<span id="vonmises-graph-builders-module"></span><h2>vonmises.graph_builders module<a class="headerlink" href="#module-vonmises.graph_builders" title="Permalink to this heading"></a></h2>
<p>Classes for building molecular graph objects, masks, and adjacency matrices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.graph_builders.BuildVonMisesGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.graph_builders.</span></span><span class="sig-name descname"><span class="pre">BuildVonMisesGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_torsions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/graph_builders.html#BuildVonMisesGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.graph_builders.BuildVonMisesGraph" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for building a graph object to pass into prediction models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_nodes</strong> (<em>int</em>) – Vertex padding parameter.</p></li>
<li><p><strong>max_torsions</strong> (<em>int</em>) – Torsion padding parameter.</p></li>
<li><p><strong>include_target</strong> (<em>bool</em>) – Whether to include the targets in the graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.graph_builders.CalculateAdjacencyMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.graph_builders.</span></span><span class="sig-name descname"><span class="pre">CalculateAdjacencyMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MAX_nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/graph_builders.html#CalculateAdjacencyMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.graph_builders.CalculateAdjacencyMatrix" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to calculate the adjacency matrix of a graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>MAX_nodes</strong> (<em>int</em>) – Parameter for padding.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.graph_builders.CalculateMask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.graph_builders.</span></span><span class="sig-name descname"><span class="pre">CalculateMask</span></span><a class="reference internal" href="_modules/vonmises/graph_builders.html#CalculateMask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.graph_builders.CalculateMask" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generates the mask for a molecule.</p>
</dd></dl>

</section>
<section id="module-vonmises.mol_utils">
<span id="vonmises-mol-utils-module"></span><h2>vonmises.mol_utils module<a class="headerlink" href="#module-vonmises.mol_utils" title="Permalink to this heading"></a></h2>
<p>RDKit auxiliary functions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.mol_utils.TorsionBondType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">TorsionBondType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#TorsionBondType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.TorsionBondType" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Class defining torsion bond types.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.mol_utils.TorsionBondType.AROMATIC_RING">
<span class="sig-name descname"><span class="pre">AROMATIC_RING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#vonmises.mol_utils.TorsionBondType.AROMATIC_RING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.mol_utils.TorsionBondType.NON_AROMATIC_NON_RING">
<span class="sig-name descname"><span class="pre">NON_AROMATIC_NON_RING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#vonmises.mol_utils.TorsionBondType.NON_AROMATIC_NON_RING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.mol_utils.TorsionBondType.NON_AROMATIC_RING">
<span class="sig-name descname"><span class="pre">NON_AROMATIC_RING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#vonmises.mol_utils.TorsionBondType.NON_AROMATIC_RING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.mol_utils.TorsionBondType.NOT_SET">
<span class="sig-name descname"><span class="pre">NOT_SET</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#vonmises.mol_utils.TorsionBondType.NOT_SET" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.mol_utils.TorsionBondType.ROTATABLE">
<span class="sig-name descname"><span class="pre">ROTATABLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#vonmises.mol_utils.TorsionBondType.ROTATABLE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.calc_energy_grad">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">calc_energy_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_field</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#calc_energy_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.calc_energy_grad" title="Permalink to this definition"></a></dt>
<dd><p>Compute MMFF energy and gradient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>ndarray</em>) – Atomic coordinates.</p></li>
<li><p><strong>force_field</strong> (<em>ForceField</em>) – RDKit force field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MMFF energy and gradient, where the energy is kcal/mol and the gradient is kcal/mol/Angstrom.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[float, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.classify_bonds_torsion_type">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">classify_bonds_torsion_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#classify_bonds_torsion_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.classify_bonds_torsion_type" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion bond types for each torsion bond in a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit molecule object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_angle">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_angle" title="Permalink to this definition"></a></dt>
<dd><p>Compute angle given bond lengths and 13 distance using Law of Cosines. This function uses soft cutoffs in order to
compensate for numerical precision issues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d1</strong> (<em>float</em>) – First bond length.</p></li>
<li><p><strong>d2</strong> (<em>float</em>) – Second bond length.</p></li>
<li><p><strong>angle12</strong> (<em>float</em>) – Angle distance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angle in radians.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_angle_triplets">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_angle_triplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_angle_triplets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_angle_triplets" title="Permalink to this definition"></a></dt>
<dd><p>Compute triples of atom indices that define all angles in a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angle triplets list as well as column names for angles dataframe, used in compute_angles function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>, <em>Dict</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_angles">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_angles" title="Permalink to this definition"></a></dt>
<dd><p>Compute all 1-3 bond angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array containing all 1-3 angles for each conformation as well as corresponding angle index triplets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_aromatic_ring_bond_torsions">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_aromatic_ring_bond_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_aromatic_ring_bond_torsions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_aromatic_ring_bond_torsions" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for aromatic ring bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_aromatic_ring_bonds">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_aromatic_ring_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_aromatic_ring_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_aromatic_ring_bonds" title="Permalink to this definition"></a></dt>
<dd><p>Compute aromatic ring bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of begin and end atom indices for the bonds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_bond_idxs">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_bond_idxs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_bond_idxs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_bond_idxs" title="Permalink to this definition"></a></dt>
<dd><p>Compute bond idxs for pair of begin and end atom indices in a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>bond_list</strong> – List of begin and end atom RDKit indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RDKit bond indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_chirality">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_chirality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_chirality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_chirality" title="Permalink to this definition"></a></dt>
<dd><p>Compute chirality of a single conformer in a consistent fashion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>conformer</strong> (<em>Conformer</em>) – RDKit conformer object.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – Index of atom to compute chirality for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Chirality (oriented volume value of +/- 1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_chirality_all_confs">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_chirality_all_confs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_chirality_all_confs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_chirality_all_confs" title="Permalink to this definition"></a></dt>
<dd><p>Compute chirality for all conformers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>atom_index</strong> – Atom index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of chiralities (oriented volumes)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_chirality_probability_targets">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_chirality_probability_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_chirality_probability_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_chirality_probability_targets" title="Permalink to this definition"></a></dt>
<dd><p>Compute chirality probability targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict of chiralities and atom indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_lengths">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_lengths" title="Permalink to this definition"></a></dt>
<dd><p>Compute all bond lengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array and list of bond indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_non_aromatic_ring_bond_torsions">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_non_aromatic_ring_bond_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_non_aromatic_ring_bond_torsions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_non_aromatic_ring_bond_torsions" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for non-aromatic ring bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_non_aromatic_ring_bonds">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_non_aromatic_ring_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_non_aromatic_ring_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_non_aromatic_ring_bonds" title="Permalink to this definition"></a></dt>
<dd><p>Compute non-aromatic ring bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of begin and end atom indices for the bonds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_non_rotatable_non_ring_bond_torsions">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_non_rotatable_non_ring_bond_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_non_rotatable_non_ring_bond_torsions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_non_rotatable_non_ring_bond_torsions" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for non-rotatable non-ring bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_non_rotatable_non_ring_bonds">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_non_rotatable_non_ring_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_non_rotatable_non_ring_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_non_rotatable_non_ring_bonds" title="Permalink to this definition"></a></dt>
<dd><p>Compute non-rotatable non-ring bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of begin and end atom indices for the bonds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_num_torsion_modes">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_num_torsion_modes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_num_torsion_modes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_num_torsion_modes" title="Permalink to this definition"></a></dt>
<dd><p>Compute # torsion modes for a set of torsion distributions by counting maxima in a kernel density estimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – DataFrame containing torsion angles (# confs x # bonds).</p></li>
<li><p><strong>shift</strong> (<em>float</em>) – Amount (radians) by which to do incremental modular shifts of the distribution.</p></li>
<li><p><strong>bw_method</strong> (<em>float</em>) – Estimator bandwidth (kde.factor).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame of shape (# confs x 2). Column 0 is bond name, column 1 is mode count.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_rotatable_bond_torsions">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_rotatable_bond_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_rotatable_bond_torsions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_rotatable_bond_torsions" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for rotatable bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_torsions">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_rotatable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_first_conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_torsions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_torsions" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for torsion bonds and all conformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>restrict_to_rotatable</strong> (<em>bool</em>) – Whether or not to only consider rotatable bond torsions.</p></li>
<li><p><strong>restrict_to_first_conf</strong> (<em>bool</em>) – Whether or not to only use the first conformation in the mol object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with information on torsion angles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_torsions_data_frame">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_torsions_data_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_torsions_data_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_torsions_data_frame" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for a set of bonds defined by pairs of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object containing conformations.</p></li>
<li><p><strong>bonds</strong> (<em>ndarray</em>) – Bonds defined by begin and end atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_torsions_for_bond">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_torsions_for_bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_to_first_conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_torsions_for_bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_torsions_for_bond" title="Permalink to this definition"></a></dt>
<dd><p>Compute torsion angles for all conformations for a given bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>bond</strong> (<em>Tuple</em>) – Bond indices.</p></li>
<li><p><strong>restrict_to_first_conf</strong> (<em>bool</em>) – Whether or not to only use the first conformation in the mol object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bond index, torsions, and atoms defining the torsion angle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.compute_volume">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">compute_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conformer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#compute_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.compute_volume" title="Permalink to this definition"></a></dt>
<dd><p>Compute oriented volume given four points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>+1 or -1 oriented volume.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>indices</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – </p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.count_lone_pairs">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">count_lone_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#count_lone_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.count_lone_pairs" title="Permalink to this definition"></a></dt>
<dd><p>Count the number of lone pairs on an atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>atom_idx</strong> (<em>int</em>) – Index of atom of interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of lone pairs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.draw_mol">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">draw_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#draw_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.draw_mol" title="Permalink to this definition"></a></dt>
<dd><p>Draw a molecule as a PNG file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> – RDKit mol object.</p></li>
<li><p><strong>output_path</strong> – File output path.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.filter_conformation">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">filter_conformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#filter_conformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.filter_conformation" title="Permalink to this definition"></a></dt>
<dd><p>Determine whether a conformation should be filtered based on the average of van Der Waals radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – Molecule object.</p></li>
<li><p><strong>conf_idx</strong> (<em>int</em>) – Conformation index to check for filtering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean indicating filtering.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.flip_chirality">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">flip_chirality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformer_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#flip_chirality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.flip_chirality" title="Permalink to this definition"></a></dt>
<dd><p>Flip the chirality of a chirality inversion atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit molecule object.</p></li>
<li><p><strong>conformer_index</strong> – Index of conformer in list of RDKit conformers.</p></li>
<li><p><strong>atom_index</strong> – Atom index.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.get_all_conf_pos">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">get_all_conf_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#get_all_conf_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.get_all_conf_pos" title="Permalink to this definition"></a></dt>
<dd><p>Create a numpy array of N confs x M atoms x 3 conformation positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.get_bond_index_paths">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">get_bond_index_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#get_bond_index_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.get_bond_index_paths" title="Permalink to this definition"></a></dt>
<dd><p>For an atom pair (i, j) where i &lt; j, compute the bond indices of the shortest path between them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping atom pair tuples to list of bond indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.get_bond_sorted_atoms">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">get_bond_sorted_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#get_bond_sorted_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.get_bond_sorted_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Get begin and end atoms for a bond in consistent fashion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bond</strong> – RDKit bond object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Begin and end atom indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.get_conf_dist">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">get_conf_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#get_conf_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.get_conf_dist" title="Permalink to this definition"></a></dt>
<dd><p>Create distance matrix from conformation position matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos</strong> – Conformation position matrix.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.neighbor_search">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">neighbor_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tied_neighbors_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visited</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#neighbor_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.neighbor_search" title="Permalink to this definition"></a></dt>
<dd><p>Search through neighbors of neighbors to determine a priority index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>tied_neighbors_dict</strong> – Dictionary mapping tied neighbor to a dictionary of neighbors ordered by atomic number.</p></li>
<li><p><strong>visited</strong> – Atom indices that we have visited.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Information about the search.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.plot_torsion_joint_histograms">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">plot_torsion_joint_histograms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_hist_bw_adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#plot_torsion_joint_histograms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.plot_torsion_joint_histograms" title="Permalink to this definition"></a></dt>
<dd><p>Plot pairwise joint histogram of all torsion distributions in the given DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – DataFrame of torsion angles for a set of conformations and bonds (# conformations x # bonds).</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em><em> | </em><em>None</em>) – Histogram weights.</p></li>
<li><p><strong>bin_width</strong> (<em>float</em>) – Histogram bin width.</p></li>
<li><p><strong>joint_hist_bw_adjust</strong> (<em>float</em>) – bw_adjust value for kernel density estimate in lower triangle of grid.</p></li>
<li><p><strong>plot_diag</strong> (<em>bool</em>) – Whether or not to plot diagonals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Figure</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.rdkit_get_bond_index_paths_slow">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">rdkit_get_bond_index_paths_slow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#rdkit_get_bond_index_paths_slow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.rdkit_get_bond_index_paths_slow" title="Permalink to this definition"></a></dt>
<dd><p>For an atom pair (i, j) where i &lt; j, compute the bond indices of the shortest path between them. Slow version.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping atom pair tuples to list of bond indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.reorder_mol_atoms_like_smiles">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">reorder_mol_atoms_like_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#reorder_mol_atoms_like_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.reorder_mol_atoms_like_smiles" title="Permalink to this definition"></a></dt>
<dd><p>Reorder the atoms in a molecule using the ordering from a SMILES parsing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Mol</em>) – RDKit Mol object (with explicit H atoms).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>Mol</em>, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.select_atom_priority_indices_for_chirality">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">select_atom_priority_indices_for_chirality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#select_atom_priority_indices_for_chirality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.select_atom_priority_indices_for_chirality" title="Permalink to this definition"></a></dt>
<dd><p>Select atom indices in order of priority for computing chirality consistently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – Index of atom to compute chirality for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atom indices in order of priority.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.select_atom_priority_neighbor">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">select_atom_priority_neighbor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#select_atom_priority_neighbor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.select_atom_priority_neighbor" title="Permalink to this definition"></a></dt>
<dd><p>Select one neighbor of an atom in a consistent fashion using rules based on CIP ranking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit molecule.</p></li>
<li><p><strong>neighbors</strong> (<em>ndarray</em>) – Neighbor atomic indices to select from.</p></li>
<li><p><strong>source</strong> (<em>int</em>) – Atom index for which we want to select a neighbor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of selected neighbor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.mol_utils.select_dihedral_atom_indices">
<span class="sig-prename descclassname"><span class="pre">vonmises.mol_utils.</span></span><span class="sig-name descname"><span class="pre">select_dihedral_atom_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/mol_utils.html#select_dihedral_atom_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.mol_utils.select_dihedral_atom_indices" title="Permalink to this definition"></a></dt>
<dd><p>Compute the four atom indices defining an RDKit bond’s torsion angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit molecule.</p></li>
<li><p><strong>bond_index</strong> (<em>int</em>) – Bond index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of atoms defining torsion angle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[int, int, int, int]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.net_utils">
<span id="vonmises-net-utils-module"></span><h2>vonmises.net_utils module<a class="headerlink" href="#module-vonmises.net_utils" title="Permalink to this heading"></a></h2>
<p>Neural network util functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vonmises.net_utils.dense_loss">
<span class="sig-prename descclassname"><span class="pre">vonmises.net_utils.</span></span><span class="sig-name descname"><span class="pre">dense_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_preds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/net_utils.html#dense_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.net_utils.dense_loss" title="Permalink to this definition"></a></dt>
<dd><p>Dense von Mises loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Dense graph batch.</p></li>
<li><p><strong>targets</strong> – Targets.</p></li>
<li><p><strong>loc_preds</strong> – von Mises loc predictions.</p></li>
<li><p><strong>conc_preds</strong> – von Mises concentration predictions.</p></li>
<li><p><strong>weight_preds</strong> – von Mises weight predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.net_utils.dense_loss_chirality">
<span class="sig-prename descclassname"><span class="pre">vonmises.net_utils.</span></span><span class="sig-name descname"><span class="pre">dense_loss_chirality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_preds_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_preds_neg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_preds_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_preds_neg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_preds_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_preds_neg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/net_utils.html#dense_loss_chirality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.net_utils.dense_loss_chirality" title="Permalink to this definition"></a></dt>
<dd><p>Dense von Mises loss for rotatable bonds connected to a chirality inversion atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – Dense graph batch.</p></li>
<li><p><strong>targets</strong> – Targets.</p></li>
<li><p><strong>loc_preds_pos</strong> – von Mises loc predictions, positive chirality.</p></li>
<li><p><strong>loc_preds_neg</strong> – von Mises loc predictions, negative chirality.</p></li>
<li><p><strong>conc_preds_pos</strong> – von Mises concentration predictions, positive chirality.</p></li>
<li><p><strong>conc_preds_neg</strong> – von Mises concentration predictions, negative chirality.</p></li>
<li><p><strong>weight_preds_pos</strong> – von Mises weight predictions, positive chirality.</p></li>
<li><p><strong>weight_preds_neg</strong> – von Mises weight predictions, negative chirality.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.net_utils.param_count">
<span class="sig-prename descclassname"><span class="pre">vonmises.net_utils.</span></span><span class="sig-name descname"><span class="pre">param_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/net_utils.html#param_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.net_utils.param_count" title="Permalink to this definition"></a></dt>
<dd><p>Determine number of trainable parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>Module</em>) – An nn.Module.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of trainable parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.net_utils.von_mises_logprob_nogeo">
<span class="sig-prename descclassname"><span class="pre">vonmises.net_utils.</span></span><span class="sig-name descname"><span class="pre">von_mises_logprob_nogeo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/net_utils.html#von_mises_logprob_nogeo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.net_utils.von_mises_logprob_nogeo" title="Permalink to this definition"></a></dt>
<dd><p>Compute the von Mises data likelihood without using pytorch-scatter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loc</strong> (<em>Tensor</em>) – von Mises loc parameters [num_torsions x num_von_mises].</p></li>
<li><p><strong>concentration</strong> (<em>Tensor</em>) – von Mises concentration parameters [num_torsions x num_von_mises].</p></li>
<li><p><strong>log_weights</strong> (<em>Tensor</em>) – log of von Mises weights [num_torsions x num_von_mises].</p></li>
<li><p><strong>data</strong> (<em>Tensor</em>) – Data to evaluate log probability [num_confs x num_bonds].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Likelihood of bond in each data point [num_confs x num_bonds].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.net_utils.von_mises_loss_stable">
<span class="sig-prename descclassname"><span class="pre">vonmises.net_utils.</span></span><span class="sig-name descname"><span class="pre">von_mises_loss_stable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/net_utils.html#von_mises_loss_stable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.net_utils.von_mises_loss_stable" title="Permalink to this definition"></a></dt>
<dd><p>Compute the von Mises mixture loss on data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loc</strong> (<em>Tensor</em>) – von Mises loc parameters [num_torsions x num_von_mises].</p></li>
<li><p><strong>concentration</strong> (<em>Tensor</em>) – von Mises concentration parameters [num_torsions x num_von_mises].</p></li>
<li><p><strong>log_weights</strong> (<em>Tensor</em>) – log of von Mises weights [num_torsions x num_von_mises].</p></li>
<li><p><strong>data</strong> (<em>Tensor</em>) – Data to evaluate log probability [num_confs x num_bonds].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Negative log likelihood of data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.nets">
<span id="vonmises-nets-module"></span><h2>vonmises.nets module<a class="headerlink" href="#module-vonmises.nets" title="Permalink to this heading"></a></h2>
<p>VonMisesNet definition.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.nets.GCNLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.nets.</span></span><span class="sig-name descname"><span class="pre">GCNLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_vertices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#GCNLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.GCNLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A single GCN layer with message passing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> – Feature size of expected input tensors.</p></li>
<li><p><strong>num_vertices</strong> (<em>int</em>) – Number of vertices per graph of expected inputs.</p></li>
<li><p><strong>extra_norm</strong> (<em>str</em>) – Normalizations before each extra layer (if non-empty, length should equal extra_layers).</p></li>
<li><p><strong>extra_layers</strong> (<em>int</em>) – Number of extra linear layers to add.</p></li>
<li><p><strong>end_norm</strong> (<em>str</em>) – Normalization to apply after all extra layers.</p></li>
<li><p><strong>order</strong> (<em>bool</em>) – Whether to do the linear layer before the message passing (True) or after (False).</p></li>
<li><p><strong>reduce</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.nets.GCNLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_i_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#GCNLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.GCNLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_i_in</strong> – Features tensors for nodes in graph.</p></li>
<li><p><strong>G</strong> – Adjacency matrix of graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vonmises.nets.GCNLayer.message_passing">
<span class="sig-name descname"><span class="pre">message_passing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_i_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#GCNLayer.message_passing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.GCNLayer.message_passing" title="Permalink to this definition"></a></dt>
<dd><p>Completes message passing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_i_in</strong> – Features tensors for nodes in graph.</p></li>
<li><p><strong>G</strong> – Adjacency matrix of graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.nets.GCNLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#vonmises.nets.GCNLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.nets.GCNStack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.nets.</span></span><span class="sig-name descname"><span class="pre">GCNStack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_vertices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#GCNStack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.GCNStack" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A stack of GCN layers with options for how to loop over each layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – Feature size of expected input tensors.</p></li>
<li><p><strong>num_vertices</strong> (<em>int</em>) – Number of vertices per graph of expected inputs.</p></li>
<li><p><strong>extra_norm</strong> (<em>str</em>) – Normalizations before each extra layer (if non-empty, length should equal extra_layers).</p></li>
<li><p><strong>extra_layers</strong> (<em>int</em>) – Number of extra linear layers to add.</p></li>
<li><p><strong>end_norm</strong> (<em>str</em>) – Normalization to apply after all extra layers.</p></li>
<li><p><strong>order</strong> (<em>bool</em>) – Whether to do the linear layer before the message passing (True) or after (False).</p></li>
<li><p><strong>reduce</strong> (<em>str</em>) – How to merge messages passed to each vertex (see reduce in pytorch_scatter).</p></li>
<li><p><strong>use_residual</strong> (<em>bool</em>) – Whether to add the residual at each layer.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.nets.GCNStack.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_i_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#GCNStack.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.GCNStack.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_i_in</strong> – Features tensors for nodes in graph.</p></li>
<li><p><strong>G</strong> – Adjacency matrix of graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.nets.GCNStack.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#vonmises.nets.GCNStack.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.nets.OutputLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.nets.</span></span><span class="sig-name descname"><span class="pre">OutputLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_linear_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#OutputLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.OutputLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A straightforward MLP for creating prediction outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_size</strong> (<em>int</em>) – Feature size of expected input tensors.</p></li>
<li><p><strong>final_linear_size</strong> (<em>int</em>) – Output size of final linear layer.</p></li>
<li><p><strong>final_output_size</strong> (<em>int</em>) – Output size of MLP.</p></li>
<li><p><strong>end_norm</strong> – Normalization function to apply to final output, if any.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.nets.OutputLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_i_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#OutputLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.OutputLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v_i_in</strong> (<em>Tensor</em>) – input feature tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predictions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.nets.OutputLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#vonmises.nets.OutputLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vonmises.nets.VonMisesNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.nets.</span></span><span class="sig-name descname"><span class="pre">VonMisesNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_vertex_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_linear_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_output_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_conc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_conc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#VonMisesNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.VonMisesNet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>VonMisesNet definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_vertices</strong> – Number of vertices (padded) per graph in the expected inputs.</p></li>
<li><p><strong>num_vertex_features</strong> – The number of features per node (vertex) in the expected inputs.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em>) – Size of hidden layers.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – Number of times to repeat the message passing steps.</p></li>
<li><p><strong>final_linear_size</strong> (<em>int</em>) – Size of final linear layers.</p></li>
<li><p><strong>final_output_size</strong> (<em>int</em>) – Output size (for each of the five outputs).</p></li>
<li><p><strong>reduce</strong> (<em>str</em>) – How to combine messages at each vertex during message passing.</p></li>
<li><p><strong>min_conc</strong> (<em>float</em>) – Minimum allowed concentration per von Mises distribution.</p></li>
<li><p><strong>max_conc</strong> (<em>float</em>) – Maximum allowed concentration per von Mises distribution.</p></li>
<li><p><strong>init_norm</strong> (<em>str</em>) – What type of normalization method to use before message passing, if any.</p></li>
<li><p><strong>linear_first</strong> (<em>bool</em>) – Whether to have linear layers before (True) or after (False) each message passing step.</p></li>
<li><p><strong>extra_norm</strong> (<em>str</em>) – What type of normalization method to use between each extra linear layer, if any.</p></li>
<li><p><strong>extra_layers</strong> (<em>int</em>) – How many extra linear layers to run after each message passing step.</p></li>
<li><p><strong>end_norm</strong> (<em>str</em>) – What type of normalization method to use after all message passing steps, if any.</p></li>
<li><p><strong>conc_norm</strong> (<em>str</em>) – What type of normalization method to use on the concentration predictions, if any.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.nets.VonMisesNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#VonMisesNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.VonMisesNet.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> – Data batch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predictions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.nets.VonMisesNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#vonmises.nets.VonMisesNet.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.nets.get_normalization_module">
<span class="sig-prename descclassname"><span class="pre">vonmises.nets.</span></span><span class="sig-name descname"><span class="pre">get_normalization_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_vertices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/nets.html#get_normalization_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.nets.get_normalization_module" title="Permalink to this definition"></a></dt>
<dd><p>Get normalization module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm_type</strong> (<em>str</em>) – Normalization type.</p></li>
<li><p><strong>hidden_size</strong> (<em>int</em>) – Hidden size.</p></li>
<li><p><strong>num_vertices</strong> (<em>int</em><em> | </em><em>None</em>) – Number of vertices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalization module.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.predictor">
<span id="vonmises-predictor-module"></span><h2>vonmises.predictor module<a class="headerlink" href="#module-vonmises.predictor" title="Permalink to this heading"></a></h2>
<p>Class to generate Von Mises predictions from mol objects.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.predictor.Predictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.predictor.</span></span><span class="sig-name descname"><span class="pre">Predictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/predictor.html#Predictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.predictor.Predictor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to generate Von Mises predictions from mol object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Path to model parameters file.</p></li>
<li><p><strong>model_config_path</strong> (<em>str</em>) – Path to model yaml config file.</p></li>
<li><p><strong>use_cuda</strong> (<em>bool</em>) – Whether to use CUDA.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="vonmises.predictor.Predictor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_initial_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_geometry_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_geometry_max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_etkdg_clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conform_to_existing_conf_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/predictor.html#Predictor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.predictor.Predictor.predict" title="Permalink to this definition"></a></dt>
<dd><p>Generate predictions with von Mises model. If generate_initial_geometry is false, each input mol is required
to have at least one embedded conformation. The first conformation is used as the starting point. VonMisesNet
expects usage of explicit H atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> (<em>List</em><em>[</em><em>Mol</em><em> | </em><em>str</em><em>] </em><em>| </em><em>None</em>) – List of RDKit molecule objects or list of SMILES strings.</p></li>
<li><p><strong>smiles_input</strong> (<em>bool</em>) – Whether mols is a list of SMILES strings.</p></li>
<li><p><strong>generate_initial_geometry</strong> (<em>bool</em>) – Whether to generate a new initial geometry via ETKDG.</p></li>
<li><p><strong>initial_geometry_seed</strong> (<em>int</em>) – Seed for generating initial conformation.</p></li>
<li><p><strong>initial_geometry_max_attempts</strong> (<em>int</em>) – Number of times to re-try a failed ETKDG embedding before giving up.</p></li>
<li><p><strong>use_etkdg_clean</strong> (<em>bool</em>) – Whether or not to use ETKDG-Clean.</p></li>
<li><p><strong>conform_to_existing_conf_idx</strong> (<em>int</em>) – For ETKDG-Clean; if &gt;= 0, mirror chirality of conformation at this index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of prediction dictionaries, list of metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[<em>Dict</em>], <em>List</em>[<em>Dict</em>]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.predictor.generate_confs">
<span class="sig-prename descclassname"><span class="pre">vonmises.predictor.</span></span><span class="sig-name descname"><span class="pre">generate_confs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_confs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_confs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/predictor.html#generate_confs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.predictor.generate_confs" title="Permalink to this definition"></a></dt>
<dd><p>Generate conformations from VonMisesNet predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>Dict</em>) – VonMisesNet predictions dictionary.</p></li>
<li><p><strong>num_confs</strong> (<em>int</em>) – Number of conformations to generate per molecule.</p></li>
<li><p><strong>filter_confs</strong> (<em>bool</em>) – Whether or not to perform filtering based on inter-atomic distances.</p></li>
<li><p><strong>max_attempts</strong> (<em>int</em>) – Maximum number of attempts to generate a single conformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RDKit mol object with generated conformations embedded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Mol</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.predictor.set_torsion_angle_from_predictions">
<span class="sig-prename descclassname"><span class="pre">vonmises.predictor.</span></span><span class="sig-name descname"><span class="pre">set_torsion_angle_from_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conformation_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_von_mises</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_angle_atom_quartet</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/predictor.html#set_torsion_angle_from_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.predictor.set_torsion_angle_from_predictions" title="Permalink to this definition"></a></dt>
<dd><p>Set a torsion angle by sampling from predicted von Mises mixture distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>) – RDKit mol object.</p></li>
<li><p><strong>conformation_index</strong> (<em>int</em>) – Conformation index in mol.</p></li>
<li><p><strong>num_von_mises</strong> (<em>int</em>) – Number of von Mises distributions in the mixture.</p></li>
<li><p><strong>loc_preds</strong> (<em>Tensor</em>) – von Mises mean predictions.</p></li>
<li><p><strong>conc_preds</strong> (<em>Tensor</em>) – von Mises concentration predictions.</p></li>
<li><p><strong>weight_preds</strong> (<em>Tensor</em>) – von Mises weight predictions.</p></li>
<li><p><strong>torsion_angle_atom_quartet</strong> (<em>Tuple</em><em>[</em><em>int</em><em>]</em>) – Quartet of atom indices defining the torsion angle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises.sqlalchemy_model">
<span id="vonmises-sqlalchemy-model-module"></span><h2>vonmises.sqlalchemy_model module<a class="headerlink" href="#module-vonmises.sqlalchemy_model" title="Permalink to this heading"></a></h2>
<p>Data model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">vonmises.sqlalchemy_model.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/sqlalchemy_model.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></p>
<p>Molecules and associated metadata.</p>
<p>A simple constructor that allows initialization from kwargs.</p>
<p>Sets attributes on the constructed instance using the names and
values in <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
<p>Only keys that are present as
attributes of the instance’s class are allowed. These could be,
for example, any mapped columns or relationships.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule.id" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule.mol">
<span class="sig-name descname"><span class="pre">mol</span></span><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule.mol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule.morgan4_crc32">
<span class="sig-name descname"><span class="pre">morgan4_crc32</span></span><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule.morgan4_crc32" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule.num_atoms">
<span class="sig-name descname"><span class="pre">num_atoms</span></span><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule.num_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule.smallest_element_subset">
<span class="sig-name descname"><span class="pre">smallest_element_subset</span></span><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule.smallest_element_subset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.Molecule.source_id">
<span class="sig-name descname"><span class="pre">source_id</span></span><a class="headerlink" href="#vonmises.sqlalchemy_model.Molecule.source_id" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.create_session">
<span class="sig-prename descclassname"><span class="pre">vonmises.sqlalchemy_model.</span></span><span class="sig-name descname"><span class="pre">create_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/sqlalchemy_model.html#create_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.sqlalchemy_model.create_session" title="Permalink to this definition"></a></dt>
<dd><p>Create a SQLAlchemy db session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – File name for db session.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>db session.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Session</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vonmises.sqlalchemy_model.subset_query">
<span class="sig-prename descclassname"><span class="pre">vonmises.sqlalchemy_model.</span></span><span class="sig-name descname"><span class="pre">subset_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallest_element_subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HCON'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_mols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vonmises/sqlalchemy_model.html#subset_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vonmises.sqlalchemy_model.subset_query" title="Permalink to this definition"></a></dt>
<dd><p>SQLAlchemy query for molecule IDs satisfying max # atoms, atom type, and last digit of Morgan hash criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_path</strong> (<em>str</em>) – Path to database file.</p></li>
<li><p><strong>max_atoms</strong> (<em>int</em>) – Maximum number of atoms allowed.</p></li>
<li><p><strong>smallest_element_subset</strong> (<em>Literal</em><em>[</em><em>'HCON'</em><em>, </em><em>'HCONFSPCl'</em><em>]</em>) – Smallest element subset.</p></li>
<li><p><strong>phase</strong> (<em>Literal</em><em>[</em><em>'train'</em><em>, </em><em>'test'</em><em>]</em>) – Train or test phase.</p></li>
<li><p><strong>max_num_mols</strong> (<em>int</em>) – Maximum number of molecules to include in query result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of Molecule ids satisfying the given filters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vonmises">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vonmises" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="vonmises" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kirk Swanson, Jake Williams, Eric Jonas.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>